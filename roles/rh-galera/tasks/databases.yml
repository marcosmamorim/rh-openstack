- name: MySQL | Make sure the MySQL databases are present
  mysql_db:
    name: "{{ item.name }}"
    collation: "{{ item.collation | default('utf8_general_ci') }}"
    encoding: "{{ item.encoding | default('utf8') }}"
    state: present
  with_items: "{{mariadb_databases}}"
  when: mariadb_databases|length > 0 and inventory_hostname == galera_master
  no_log: True

- name: MySQL | Make sure the MySQL users are present
  mysql_user:
    name: "{{item.name}}"
    password: "{{item.pass | default('pass')}}"
    priv: "{{item.priv | default('*.*:ALL')}}"
    state: present
    host: "{{item.host | default('localhost')}}"
  with_items: "{{ mariadb_users }}"
  when: mariadb_users|length > 0 and inventory_hostname == galera_master
  no_log: True

