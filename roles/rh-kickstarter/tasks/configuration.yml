---

- name: create tftp xinetd service
  template: src=tftp.j2 dest=/etc/xinetd.d/tftp mode=0644 owner=root group=root
  tags:
    - kickstart

- name: create dirs rhel-server
  file:
    dest={{ item }}
    state=directory
  with_items:
    - /var/www/html/iso
    - "/var/www/html/{{ rhel_prefix }}"
    - /var/www/html/ks
  tags:
    - kickstart

#- name: image rhel server
#  copy: src=iso/{{ rhel_prefix }}-x86_64-dvd.iso dest=/var/www/html/iso/{{ rhel_prefix }}-x86_64-dvd.iso mode=0644
#  when: use_rhel_iso
#  tags:
#    - kickstart

- name: Copy over tftpboot configuration
  copy:
    src=tftpboot
    dest=/var/lib/
  when: use_rhel_iso or use_rhel_http
  tags:
    - kickstart

- name: configure pxe
  template: src=default.j2 dest=/var/lib/tftpboot/pxelinux/pxelinux.cfg/default mode=0644
  when: use_rhel_iso or use_rhel_http
  tags:
    - kickstart

- name: template ks rhel
  template: src={{rhel_prefix}}.ks.j2 dest=/var/www/html/ks/{{rhel_prefix}}.ks mode=0644
  tags:
    - kickstart

- name: Dhcp Configure
  template: src=dhcpd.conf.j2 dest=/etc/dhcp/dhcpd.conf mode=0644
  tags:
    - kickstart
